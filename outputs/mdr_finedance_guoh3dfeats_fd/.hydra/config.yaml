data:
  motion_loader:
    _target_: src.data.motion.AMASSMotionLoader
    base_dir: datasets/motions/guoh3dfeats_fd
    normalizer:
      _target_: src.data.motion.Normalizer
      base_dir: stats/${hydra:runtime.choices.data}/${hydra:runtime.choices.data/motion_loader}
      eps: 1.0e-12
    fps: 20.0
    nfeats: 263
  _target_: src.data.music_dance.MusicDanceDataset
  path: datasets/annotations/${hydra:runtime.choices.data}
  jukebox_feats_dir: ../datasets/finedance/fd_music_wav_checked_partation_jukebox
  clap_token_feats_dir: ../datasets/finedance/fd_music_feats_clap_token
  clap_sent_feats_dir: ../datasets/finedance/fd_music_feats_clap_sent
  preload: true
model:
  _target_: src.model.TMR
  motion_encoder:
    _target_: src.model.ACTORStyleEncoder
    nfeats: ${data.motion_loader.nfeats}
    vae: true
    latent_dim: 256
    ff_size: 1024
    num_layers: 6
    num_heads: 4
    dropout: 0.1
    activation: gelu
  text_encoder:
    _target_: src.model.ACTORStyleEncoder
    nfeats: 512
    vae: true
    latent_dim: 256
    ff_size: 1024
    num_layers: 6
    num_heads: 4
    dropout: 0.1
    activation: gelu
  motion_decoder:
    _target_: src.model.ACTORStyleDecoder
    nfeats: ${data.motion_loader.nfeats}
    latent_dim: 256
    ff_size: 1024
    num_layers: 6
    num_heads: 4
    dropout: 0.1
    activation: gelu
  vae: true
  lmd:
    recons: 1.0
    latent: 1.0e-05
    kl: 1.0e-05
    contrastive: 0.1
  lr: 0.0001
  temperature: 0.1
  threshold_selfsim: 0.9
  threshold_selfsim_metrics: 0.95
trainer:
  _target_: pytorch_lightning.Trainer
  max_epochs: 1000
  log_every_n_steps: 50
  num_sanity_val_steps: 0
  check_val_every_n_epoch: 1
  accelerator: gpu
  devices: 1
  callbacks:
  - _target_: pytorch_lightning.callbacks.ModelCheckpoint
    filename: latest-{epoch}
    every_n_epochs: 1
    save_top_k: 1
    save_last: true
  - _target_: pytorch_lightning.callbacks.ModelCheckpoint
    filename: latest-{epoch}
    monitor: step
    mode: max
    every_n_epochs: 100
    save_top_k: -1
    save_last: false
  - _target_: pytorch_lightning.callbacks.ModelCheckpoint
    monitor: val_loss
    mode: min
    save_top_k: 3
    save_last: true
    filename: e_{epoch:03d}-val_{val:.2f}
  - _target_: src.callback.progress.ProgressLogger
    precision: 3
  - _target_: src.callback.tqdmbar.TQDMProgressBar
  logger:
    _target_: pytorch_lightning.loggers.TensorBoardLogger
    save_dir: ${run_dir}
    name: ${hydra:runtime.choices.model}_${hydra:runtime.choices.data}_${hydra:runtime.choices.data/motion_loader}
run_dir: outputs/${hydra:runtime.choices.model}_${hydra:runtime.choices.data}_${hydra:runtime.choices.data/motion_loader}
seed: 1234
logger_level: INFO
ckpt: last
resume_dir: null
dataloader:
  _target_: torch.utils.data.DataLoader
  batch_size: 64
  num_workers: 8
